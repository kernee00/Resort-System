
INSERT INTO ADMIN_ACCOUNT VALUES ( 101, 'Andrew Teh', '001022100523', 'andrew@gmail.com', '0102665219','andrew123' );
INSERT INTO ADMIN_ACCOUNT VALUES ( 102, 'Carmen Yong', '980516109511', 'carmen@yahoo.com', '0126224875', 'carmen123');
INSERT INTO ADMIN_ACCOUNT VALUES (103, 'Syarifah', '850413108017', 'syarifah@gmail.com', '0135328699', 'syarifah123');
INSERT INTO ADMIN_ACCOUNT VALUES (104, 'Benedict Black', '950628109788', 'bb950628@gmail.com', '01120167052', 'bb123');
INSERT INTO ADMIN_ACCOUNT VALUES ( 105, 'Ali', '990916100526','ali0916@gmail.com', '0162563188', 'ali123');
INSERT INTO ADMIN_ACCOUNT VALUES (106, 'Ong Ah Beng', '940301105766', 'ong@yahoo.com', '0126235788' , 'ong123');
INSERT INTO ADMIN_ACCOUNT VALUES (107, 'Sudiskumar', '910715109648', 'sudiskumar@gmail.com', '0136879133', 'kumar123');
INSERT INTO ADMIN_ACCOUNT VALUES (108, 'Ahmad', '000815106319', 'admad15@gmail.com', '01151648421', 'ahmad123');
INSERT INTO ADMIN_ACCOUNT VALUES( 109, 'Mary', '981216104231', 'mary@gmail.com', '0169632161', 'mary123');
INSERT INTO ADMIN_ACCOUNT VALUES( 110, 'Sabrina', '970218108911', 'sabrina@yahoo.com', '0192015766', 'sabrina123');

INSERT INTO CUSTOMER_ACCOUNT VALUES ( 5001, 'Ah Lee', '960315105677', 'lee@yahoo.com', '01120178564', 'lee66');
INSERT INTO CUSTOMER_ACCOUNT VALUES ( 5002, 'Alvin', '991025103215', 'alvin@gmail.com', '0126549852', 'alvin00');
INSERT INTO CUSTOMER_ACCOUNT VALUES ( 5003, 'Tom White', '950613105786', 'tomw@gmail.com', '0135648975', 'tomw99');
INSERT INTO CUSTOMER_ACCOUNT VALUES ( 5004, 'Chirs', '000419106312', 'chirs00@gmail.com', '0167842359' , 'chris123');
INSERT INTO CUSTOMER_ACCOUNT VALUES ( 5005, 'Khadijah', '870916109611', 'dijah@yahoo.com', '0135486691', 'dijah123');
INSERT INTO CUSTOMER_ACCOUNT VALUES ( 5006, 'James Potter', '850619105799', 'james@gmail.com', '0175641239', 'james88');
INSERT INTO CUSTOMER_ACCOUNT VALUES ( 5007, 'Lily Lestarnge', '940823105413', 'lily08@gmail.com', '01163419827', 'lily11');
INSERT INTO CUSTOMER_ACCOUNT VALUES ( 5008, 'Marcus Ang', '980516085766', 'marcus@gmail.com', '0195642388', 'marcus123');
INSERT INTO CUSTOMER_ACCOUNT VALUES ( 5009, 'Kelly Holland', '931210085211', 'kellyh@yahoo.com', '0165297413', 'kelly12' );
INSERT INTO CUSTOMER_ACCOUNT VALUES ( 5010, 'Daniel', '911130106412', 'daniel@gmail.com', '0129834596', 'daniel11');

INSERT INTO VEHICLE VALUES  ( 'V01', 'Car', 'Proton Persona', 170, 101);
INSERT INTO VEHICLE VALUES  ( 'V02', 'Car', 'Honda Jazz', 200, 102);
INSERT INTO VEHICLE VALUES  ( 'V03', 'Car', 'Honda City', 200, 105);
INSERT INTO VEHICLE VALUES  ( 'V04', 'Motorcycle', 'KTM 250 EXC TPI', 150, 107);
INSERT INTO VEHICLE VALUES  ( 'V05', 'Motorcycle', 'Yamaha 135LC', 60, 106);
INSERT INTO VEHICLE VALUES  ( 'V06', 'Car', 'Toyota Vios', 210, 101);
INSERT INTO VEHICLE VALUES  ( 'V07', 'Motorcycle', 'Modenas Kriss 110', 75, 106);
INSERT INTO VEHICLE VALUES  ( 'V08', 'Car', 'Perodua Myvi', 180, 110);
INSERT INTO VEHICLE VALUES  ( 'V09', 'Car', 'Toyota Alphard', 500, 105);
INSERT INTO VEHICLE VALUES  ( 'V10', 'Car', 'Toyota Innova', 300, 103);

INSERT INTO RENTAL VALUES (10010, '07-10-2021', '07-19-2021', '07-22-2021', 4, 840, 5004, 'V06' );
INSERT INTO RENTAL VALUES (10011, '07-30-2021', '08-01-2021', '08-05-2021', 5, 850, 5009, 'V01');
INSERT INTO RENTAL VALUES ( 10012, '09-18-2021', '09-21-2021', '09-23-2021', 3, 900, 5005, 'V10');
INSERT INTO RENTAL VALUES ( 10013, '10-01-2021', '10-08-2021', '10-10-2021', 3, 180, 5010, 'V05');
INSERT INTO RENTAL VALUES (10014, '10-10-2021', '10-15-2021', '10-18-2021', 4, 800, 5001, 'V03');
INSERT INTO RENTAL VALUES (10015, '10-19-2021', '10-22-2021', '10-26-2021', 5, 1000, 5008, 'V02');
INSERT INTO RENTAL VALUES  (10016, '11-06-2021', '11-11-2021', '11-15-2021', 5, 1000, 5001, 'V02');
INSERT INTO RENTAL VALUES  ( 10017, '11-10-2021', '11-16-2021', '11-20-2021', 5, 375, 5007, 'V07');
INSERT INTO RENTAL VALUES ( 10018, '12-01-2021', '12-09-2021', '12-12-2021', 4, 240, 5009, 'V05');
INSERT INTO RENTAL VALUES ( 10019, '12-20-2021', '12-25-2021', '12-30-2021', 6, 1200, 5003, 'V03');

INSERT INTO RENTAL VALUES ( 10012,  '2021-09-21', '2021-09-23', 3, 900, 1009, 500002);
INSERT INTO RENTAL VALUES ( 10013,  '2021-10-08', '2021-10-10', 3, 180, 1002, 500001);
INSERT INTO RENTAL VALUES (10014, '2021-10-15', '2021-10-18', 4, 800, 1001, 500000);
DATE = YYYY-MM-DD


SELECT to_char(Rental_Date, 'mon') AS MONTH, SUM(Total_Price) AS MONTHLY
FROM RENTAL
GROUP BY to_char(Rental_Date, 'mon') 
ORDER BY to_char(Rental_Date, 'mon') DESC ;


MYSQL

//display in correct order 
SELECT MONTHNAME(Start_Date) AS MONTH, SUM(Total_Price) AS MONTHLY
FROM RENTAL
GROUP BY MONTHNAME(Start_Date)
ORDER BY MONTH(Start_Date) ASC;

//yearly report
SELECT YEAR(Start_Date), SUM(Total_Price)
FROM rental
GROUP BY YEAR(Start_Date)
ORDER BY YEAR(Start_Date);
---------------------------------------------------------

CREATE TABLE ADMIN_ACCOUNT(
    Admin_ID INT  NOT NULL，
    Admin_Name VARCHAR(50) NOT NULL,
    Admin_IC VARCHAR(12) NOT NULL,
    Email VARCHAR(30) NOT NULL,
    Admin_Phone VARCHAR(11) NOT NULL,
    Passwords VARCHAR(20) NOT NULL,
    CONSTRAINT admin_id_pk PRIMARY KEY (Admin_ID)

);


CREATE TABLE CUSTOMER_ACCOUNT(
    Cust_ID INT  NOT NULL，
    Cust_Name VARCHAR(50) NOT NULL,
    License_No VARCHAR(12) NOT NULL,
    Email VARCHAR(30) NOT NULL,
    Phone_No VARCHAR(11) NOT NULL,
    Passwords VARCHAR(20) NOT NULL,
    CONSTRAINT cust_id_pk PRIMARY KEY (Cust_ID)
);



CREATE TABLE VEHICLE (
    Vehicle_ID INT NOT NULL AUTO_INCREMENT,
    Vehicle_Type VARCHAR(12) NOT NULL,
    Vehicle_Model VARCHAR(50) NOT NULL,
    Plate_No VARCHAR(8) NOT NULL,
    Vehicle_Capacity INT NOT NULL,
    Price_Per_Day DOUBLE(6,2) NOT NULL,
    Admin_ID INT NOT NULL,
    CONSTRAINT vehicle_id_pk PRIMARY KEY (Vehicle_ID),
    CONSTRAINT admin_id_fk FOREIGN KEY (Admin_ID) REFERENCES ADMIN_ACCOUNT (Admin_ID)

);


ALTER TABLE VEHICLE AUTO_INCREMENT = 10000;
CREATE TABLE RENTAL(
    Rental_ID INT  NOT NULL AUTO_INCREMENT,
    Start_Date DATE NOT NULL,
    End_Date DATE NOT NULL,
    Total_Days INT,
    Total_Price DOUBLE (6,2),
    Cust_ID INT NOT NULL,
    Vehicle_ID INT ,
    CONSTRAINT rental_id_pk PRIMARY KEY (Rental_ID),
    CONSTRAINT user_id_fk FOREIGN KEY (Cust_ID) REFERENCES CUSTOMER_ACCOUNT (Cust_ID),
    CONSTRAINT vehicle_id_fk FOREIGN KEY (Vehicle_ID) REFERENCES VEHICLE (Vehicle_ID)
);

ALTER TABLE RENTAL AUTO_INCREMENT = 500000;

--------------------TO COUNT TOTAL DAYS-------------
UPDATE rental
SET total_days = DATEDIFF(End_Date, Start_Date) +1
WHERE Rental_ID = 10025;
DATEDIFF function

UPDATE rental
INNER JOIN 
vehicle ON rental.Vehicle_ID = vehicle.Vehicle_ID
SET Total_Price = Total_Days * vehicle.Price_Per_Day
WHERE Rental_ID = 10025;

SELECT Rental_ID FROM RENTAL WHERE Rental_ID = LAST_INSERT_ID();

SELECT * FROM Vehicle WHERE Vehicle_Type = 'Car' AND  Vehicle_ID NOT IN ( SELECT Vehicle_ID FROM Rental WHERE (rental.Start_Date BETWEEN '2021-12-10 ' AND'2021-12-15' OR rental.End_Date BETWEEN '2021-12-10 ' AND'2021-12-15' ) );